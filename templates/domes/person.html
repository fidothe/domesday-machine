{% extends "domes/base.html" %}

{% block title %}{{ person.name }} {% endblock %}
{% block description %}Places in the Domesday Book owned by {{ person.name}} {% endblock %}
{% block nav-class %}nav-people{% endblock %}

{% block content %}

<div class="page_title">
<h1>Person: {{ person.name }}</h1>
</div>

<div class="content">

<div id="divMap">
<div id="map_canvas" style="width:400px; height:400px;"></div>
</div>
</div>

<p>Places owned by <strong>{{ person.name.upper }}</strong>.</p>

<ul>
{% if person.namecode %}<li><strong>Name code:</strong> {{ person.namecode }}</li>{% endif %}
{% if person.gendercode %}<li><strong>Gender:</strong> {{ person.gendercode }}{% endif %}
{% if person.churchcode %}<li><strong>Church affiliation:</strong> {{ person.churchcode }}{% endif %}
{% if person.xrefs %}<li><strong>References:</strong>  {{ person.xrefs }}{% endif %}
</ul>

<!-- <p>Owned {{ person.lord66.count|add:person.overlord66.count }} places before the Conquest;
 {{ person.lord86.count|add:person.teninchief.count }}  after the Conquest.</p>-->

{% if person.lord66.count > 0 or person.overlord66.count > 0 %}
<p style="font-variant: small-caps; font-weight: bold;">Before the Conquest</p>
{% endif %}
{% if person.lord66.count > 0 %}
<p style="font-weight: bold;">Lord in 1066:</p>
<ul>

{% for manor in person.lord66.all %}
{% for place in manor.place.all %}
<li> 
<a href="{% url place place.grid place.vill_slug %}">{{ place.vill }}</a>, 
 {{ place.hundred }}, {% for county in place.county.all %}{{ county }} {% endfor %}
</li>
{% endfor %}
{% endfor %}
</ul>
{% endif %}
{% if person.overlord66.count > 0 %}
<p style="font-weight: bold;">Overlord in 1066:</p>
<ul>
{% for manor in person.overlord66.all %}
{% for place in manor.place.all %}
<li> 
<a href="{% url place place.grid place.vill_slug %}">{{ place.vill }}</a>, 
  {{ place.hundred }}, {% for county in place.county.all %}{{ county }} {% endfor %}
</li>
{% endfor %}
{% endfor %}
</ul>
{% endif %}

{% if person.lord86.count > 0 or person.teninchief.count > 0 %}
<p style="font-variant: small-caps; font-weight: bold;">After the Conquest</p>
{% endif %}
{% if person.lord86.count > 0 %}
<p style="font-weight: bold;">Lord in 1086:</p>
<ul>
{% for manor in person.lord86.all %}
{% for place in manor.place.all %}
<li> 
<a href="{% url place place.grid place.vill_slug %}">{{ place.vill }}</a>, 
  {{ place.hundred }}, {% for county in place.county.all %}{{ county }} {% endfor %}
</li>
{% endfor %}
{% endfor %}
</ul>
{% endif %}
{% if person.teninchief.count > 0 %}
<p style="font-weight: bold;">Tenant-in-chief in 1086:</p>
<ul>
{% for manor in person.teninchief.all %}
{% for place in manor.place.all %}
<li> 
<a href="{% url place place.grid place.vill_slug %}">{{ place.vill }}</a>, 
  {{ place.hundred }}, {% for county in place.county.all %}{{ county }} {% endfor %}
</li>
{% endfor %}
{% endfor %}
</ul>
{% endif %}


</div>


<script type='text/javascript'>
window.onload = set_up_map();
{% for manor in person.lord66.all %}
{% for place in manor.place.all %}
addMarker('{{place.location.y}}', '{{place.location.x}}', '{{place.grid}}', '{{place.vill}}', '{{place.vill_slug}}', '{{place.hundred}}', '{{place.county}}', '{{place.holding}}', '{{place.units}}', '0066FF' );
{% endfor %}
{% endfor %}
{% for manor in person.lord86.all %}
{% for place in manor.place.all %}
addMarker('{{place.location.y}}', '{{place.location.x}}', '{{place.grid}}', '{{place.vill}}', '{{place.vill_slug}}', '{{place.hundred}}', '{{place.county}}', '{{place.holding}}', '{{place.units}}', '0066FF' );
{% endfor %}
{% endfor %}
{% for manor in person.overlord66.all %}
{% for place in manor.place.all %}
addMarker('{{place.location.y}}', '{{place.location.x}}', '{{place.grid}}', '{{place.vill}}', '{{place.vill_slug}}', '{{place.hundred}}', '{{place.county}}', '{{place.holding}}', '{{place.units}}', '0066FF' );
{% endfor %}
{% endfor %}
{% for manor in person.teninchief.all %}
{% for place in manor.place.all %}
addMarker('{{place.location.y}}', '{{place.location.x}}', '{{place.grid}}', '{{place.vill}}', '{{place.vill_slug}}', '{{place.hundred}}', '{{place.county}}', '{{place.holding}}', '{{place.units}}', '0066FF' );
{% endfor %}
{% endfor %}
</script>

{% endblock %}


